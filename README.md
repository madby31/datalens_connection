# Простые подключения к Yandex.Cloud Datalens
## Две таблицы из Google Sheets (Гугл Таблиц) через CSV. Публичный доступ к дашборду из Google Sheets.
В подключении Datalens `Google Sheets` можно подключить только один лист из Таблиц. Но что делать, если надо две или более таблиц, которые связаны друг с другом по отдельным полям. Очевидно, что заполнять одну большую таблицу. Но бывает, что таблицы заполняются автоматически, например CRM, или их ведет другое отдел, или сотрудники, которым "вот так удобно". Или нужен публичный доступ к дашборду. Datalens отключили материлиазацию и для подключения `Google Sheets` публичный доступ недоступен.
Что делать, работаем через подключение `File` то есть CSV. Трудозатратнее, обновление вручную, но больше возможностей.
- можем склеивать\джойнить несколько листов из Таблиц, даже из разных документов;
- полученный дашборд можно сделать публичным;
- остается возможность обновления данных вручную.

Давайте рассмотрим простой пример работы с Google Sheets через CSV. Есть Таблица с двумя листами.

Первый лист таблицы с основными показателями.

![image](pic/14.png)

Вторая лист таблицы, в которой нас интересует колонка **Стоимость**

![image](pic/15.png)

Как видно, две таблицы объединяют колонки **Наименование** и **Название**. Названия разные, но данные в них одинаковые. Главное найти колонки с идентичными данными в двух таблицах и желательно, чтобы во второй таблице эти значения были уникальными. Например, если во второй таблице **Карандаш** в одной строке будет стоить 20, а в другой строке **Карандаш** будет стоить 15, будут неверно объединены таблицы, так как программа не смотрит на другие данные. В таких случаях надо сделать уникальные названия, например второй **Карандаш** переименовать в **Карандаш эконом**. Но это делать надо до начала экспорта в Datalens.

Продолжаем. Экспортируем каждый лист в формате CSV на свой жесткий диск.

![image](pic/40.png)

`Файл` -> `Скачать` -> `Формат CSV (.csv)`. В диалоговом окне сохраняем на жесткий диск.

Переходим на [Datalens](https://datalens.yandex.ru).

![image](pic/52.png)

Выбираем `Создать подключение`

![image](pic/53.png)

Выбираем `File`

![image](pic/54.png)

Нажимем `+ Загрузить файлы`. В диалоговом окне выбираем файлы, которые мы скачали с Таблиц, можно все сразу выделить и загрузить.

![image](pic/19.png)

Итак, наши файлы загрузились, выбирая их в левом столбце, в правом можно посмотреть их содержимое (на предпросмотре все строки не загружаются, только часть!). Типы значенй в столбцах определились правильно, то есть колонка **Дата** как дата (пиктограмма календарика), **Заказ** и **Количество** как числа (пиктограмма решетки), Наименование как строковое значение (пиктограмма А). Если тип определен неправильно, можно нажать пиктограмму и изменить его. Но в первую очередь это значит, что где-то в данных есть значение другого типа. Например, в столбце **Количество**, в одной строке вместо **0** внесено буквами **ноль**. Тогда интерпритатор весь столбец обозначит как строковый. Такие вещи надо править непосредственно в Google Sheets.

Нажимаем на `Создать подключение` в правом верхнем углу.

![image](pic/21.png)

Вводим название нашего подключения. Важно помнить, что одинаковых имен быть не должно. То есть, нельзя назвать Подключение, Датасет, Чарт и Дашборд одним именем, будет всплывать ошибка. Добавляйте префиксы к названию: **MyBIproject_connection, MyBIproject-DataSet, mybiproject_chart_gain, etc**. Можно выбрать папку, куда все добро сохранять, нажав на значок `>`

![image](pic/22.png)



